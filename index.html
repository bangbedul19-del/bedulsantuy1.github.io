<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>External Intent – Adaptive Delay</title>
<style>
  body{font-family:system-ui;padding:40px}
  button{padding:14px 22px;font-size:16px}
  pre{margin-top:12px;color:#555;white-space:pre-wrap}
</style>
</head>
<body>

<h3>Open Target → External App Dialog (Adaptive Delay)</h3>
<p>
Klik sekali. Tab baru dibuka ke target. Setelah beberapa delay percobaan,
intent eksternal dipicu (best-effort).
</p>

<button id="go">Run</button>
<pre id="log"></pre>

<script>
const logEl = document.getElementById('log');
const log = s => logEl.textContent += s + "\n";

// Delay percobaan (ms)
const DELAYS = [1200, 1800, 2400, 3000];

document.getElementById('go').onclick = () => {
  log("User click");

  // 1) Buka tab target (pindah fokus)
  window.open("https://www.google.com", "_blank");
  log("Opened target tab");

  // 2) Coba intent di beberapa delay (stop di yang pertama berhasil)
  let fired = false;
  DELAYS.forEach(d => {
    setTimeout(() => {
      if (fired) return;
      fired = true;
      log("Trigger intent at " + d + " ms");
      location.href =
        "intent://scan/#Intent;scheme=zxing;package=com.google.zxing.client.android;end";
    }, d);
  });
};
</script>

</body>
</html>